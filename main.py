import os
import time
import pyfiglet

def run_executable_file():
    file = input("Enter the path and name of the file: ")
    os.system("python3 Extract/PE_main.py {}".format(file))

def run_malicious_url_scanner():
    os.system('python3 Extract/url_main.py')

def exit_program():
    os.system('exit')

def start():
    print(pyfiglet.figlet_format("ML Malware Detector"))
    print("Welcome to the ML-Malware Detector!\n")
    print("1. Executable File scanner")
    print("2. Malicious URL scanner")
    print("3. Exit\n")

    select = int(input("Enter your choice: "))

    if select in [1, 2, 3]:

        if select == 1:
            run_executable_file()
            choice = input("Do you want to search again? (y/n) ")
            if choice.lower() not in ['y', 'n']:
                print("Invalid input. Exiting...")
                time.sleep(3)
                exit_program()
            elif choice.lower() == 'y':
                start()
            else:
                exit_program()

        elif select == 2:
            run_malicious_url_scanner()
            choice = input("Do you want to search again? (y/n) ")
            if choice.lower() not in ['y', 'n']:
                print("Invalid input. Exiting...")
                time.sleep(3)
                exit_program()
            elif choice.lower() == 'y':
                start()
            else:
                exit_program()

        else:
            exit_program()

    else:
        print("Invalid input. Exiting...")
        time.sleep(3)
        exit_program()

start()
